import os
import streamlit as st
st.set_page_config(page_title='IW - Malware Detect App', page_icon='ðŸ‘¾')

from file_checker import checkFile

st.write("<p style='font-size: 35px; font-weight: bold;'>Information Warfare - Malware Detection App</p>", unsafe_allow_html=True)

hide_st_style = """
            <style>
            #MainMenu {visibility: hidden;}
            footer {visibility: hidden;}
            header {visibility: hidden;}
            </style>
            """
st.markdown(hide_st_style, unsafe_allow_html=True)
st.write("<p style='font-size: 25px; font-weight: bold;'>IT20636838-B.H.M.P.Navodya</p>", unsafe_allow_html=True)
st.write("<p style='font-size: 20px;'>Dataset used: <a href='https://www.kaggle.com/competitions/malware-detection/data' style='text-decoration: none;'>https://www.kaggle.com/competitions/malware-detection/data</a></p>", unsafe_allow_html=True)


st.write("")
st.write("")
st.write("")

file = st.file_uploader("Upload a file to check for malwares:", accept_multiple_files=True)
if len(file):
    with st.spinner("Checking..."):
        for i in file:
            open('malwares/tempFile', 'wb').write(i.getvalue())
            legitimate = checkFile("malwares/tempFile")
            os.remove("malwares/tempFile")
            if legitimate:
                st.write(f"File {i.name} seems *LEGITIMATE*!")
            else:
                st.markdown(f"File {i.name} is probably a **MALWARE**!!!")
